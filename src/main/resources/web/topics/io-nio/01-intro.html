<h2>I/O &amp; NIO — Đọc ghi dữ liệu</h2>

<p>Java cung cấp hai mô hình I/O: <strong>java.io</strong> (Stream-based, blocking) và <strong>java.nio</strong> (Buffer/Channel-based, hỗ trợ non-blocking). I/O cũ dùng stream byte/char; NIO dùng buffer và channel, phù hợp high-throughput và multiplexing.</p>

<section>
  <h3>Tổng quan I/O vs NIO</h3>
  <table class="comparison-table">
    <caption>So sánh java.io và java.nio</caption>
    <thead>
      <tr>
        <th>Tiêu chí</th>
        <th>java.io (Stream)</th>
        <th>java.nio (Buffer/Channel)</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>Mô hình</td>
        <td>Stream — đọc/ghi tuần tự</td>
        <td>Buffer + Channel — đọc/ghi qua buffer</td>
      </tr>
      <tr>
        <td>Blocking</td>
        <td>Blocking (thread chờ I/O)</td>
        <td>Hỗ trợ non-blocking (Selector)</td>
      </tr>
      <tr>
        <td>Đơn vị xử lý</td>
        <td>Byte/char</td>
        <td>Block (Buffer)</td>
      </tr>
      <tr>
        <td>Multiplexing</td>
        <td>Không</td>
        <td>Selector — 1 thread quản lý nhiều channel</td>
      </tr>
      <tr>
        <td>Package</td>
        <td><code>java.io</code></td>
        <td><code>java.nio</code>, <code>java.nio.channels</code>, <code>java.nio.file</code></td>
      </tr>
    </tbody>
  </table>

  <h4>Luồng dữ liệu</h4>
  <pre><code>// java.io — Stream
Source → InputStream/Reader → [process] → OutputStream/Writer → Destination

// java.nio — Buffer + Channel
Source → Channel.read(ByteBuffer) → Buffer → [process] → Buffer → Channel.write(ByteBuffer) → Destination</code></pre>
</section>

<section>
  <h3>Hierarchy java.io</h3>
  <p><strong>InputStream / OutputStream</strong> — byte stream. <strong>Reader / Writer</strong> — character stream (Unicode). Các subclass: FileInputStream, BufferedInputStream, FileReader, BufferedReader... Luôn đóng stream bằng try-with-resources để tránh rò rỉ file descriptor.</p>

  <h4>Sơ đồ phân cấp</h4>
  <pre><code>InputStream
  ├── FileInputStream
  ├── ByteArrayInputStream
  ├── FilterInputStream
  │     ├── BufferedInputStream
  │     ├── DataInputStream
  │     └── GZIPInputStream (via InflaterInputStream)
  └── ObjectInputStream

Reader
  ├── FileReader
  ├── InputStreamReader  ← bridge byte → char (encoding)
  └── BufferedReader</code></pre>

  <h4>Hierarchy java.nio</h4>
  <p><strong>Buffer</strong> — ByteBuffer, CharBuffer, IntBuffer... Container cho dữ liệu. <strong>Channel</strong> — FileChannel, SocketChannel, ServerSocketChannel... Kết nối tới nguồn/đích. <strong>Selector</strong> — multiplexing nhiều channel non-blocking.</p>

  <pre><code>Buffer (ByteBuffer, CharBuffer...)
Channel
  ├── FileChannel
  ├── SocketChannel
  ├── ServerSocketChannel
  └── DatagramChannel

Selector — quản lý nhiều SelectableChannel</code></pre>

  <h4>Use case — Khi nào dùng gì</h4>
  <table class="comparison-table">
    <thead>
      <tr>
        <th>Use case</th>
        <th>Gợi ý</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>Đọc file text nhỏ</td>
        <td>Files.readAllLines() hoặc BufferedReader</td>
      </tr>
      <tr>
        <td>Đọc file binary</td>
        <td>BufferedInputStream + FileInputStream</td>
      </tr>
      <tr>
        <td>Copy file lớn</td>
        <td>FileChannel.transferTo()</td>
      </tr>
      <tr>
        <td>Server nhiều kết nối</td>
        <td>Selector + SocketChannel</td>
      </tr>
      <tr>
        <td>Duyệt thư mục</td>
        <td>Files.walk() hoặc FileVisitor</td>
      </tr>
    </tbody>
  </table>

  <section class="when-use">
    <h4>Khi nào dùng I/O vs NIO?</h4>
    <p class="when-use-do"><strong>java.io:</strong> File đơn giản, text đọc/ghi; dùng Reader/Writer cho encoding; code đơn giản, dễ hiểu.</p>
    <p class="when-use-avoid"><strong>java.nio:</strong> Tránh khi chỉ cần đọc file nhỏ; ưu tiên khi cần high-throughput, non-blocking, multiplexing (server nhiều kết nối).</p>
  </section>
</section>
