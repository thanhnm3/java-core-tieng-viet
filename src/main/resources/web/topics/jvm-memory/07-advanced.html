<section>
  <h3>Nâng cao — String Pool, Reference, Compressed OOPs</h3>

  <h4>String Pool (Intern)</h4>
  <p>Literal <code>"hello"</code> lưu trong String Pool (nằm Heap từ Java 7). <code>intern()</code> trả về reference từ pool nếu có, không thì thêm vào. Tránh duplicate string. Pool có thể OOM nếu intern quá nhiều string khác nhau.</p>

  <h4>Reference Types</h4>
  <p><strong>Strong:</strong> Bình thường — GC không thu hồi khi còn reference. <strong>SoftReference:</strong> Thu hồi khi Heap sắp OOM — dùng cache. <strong>WeakReference:</strong> Thu hồi bất kỳ lúc nào GC chạy — dùng cho metadata. <strong>PhantomReference:</strong> Dùng với ReferenceQueue — biết khi Object sắp bị thu hồi (cleanup).</p>

  <h4>Compressed OOPs</h4>
  <p>Trên 64-bit JVM, pointer 8 byte — tốn Heap. <strong>Compressed OOPs</strong> (-XX:+UseCompressedOops, mặc định): dùng 32-bit offset, scale x3 (shift left 3) để địa chỉ 8-byte aligned. Heap &lt; 32GB: dùng base + offset. Giảm ~30% memory cho Object có nhiều reference.</p>

  <table class="comparison-table">
    <caption>Reference types</caption>
    <thead>
      <tr>
        <th>Loại</th>
        <th>Thu hồi khi</th>
        <th>Use case</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>Strong</td>
        <td>Không còn reference</td>
        <td>Mặc định</td>
      </tr>
      <tr>
        <td>SoftReference</td>
        <td>Heap sắp đầy</td>
        <td>Cache</td>
      </tr>
      <tr>
        <td>WeakReference</td>
        <td>Bất kỳ GC</td>
        <td>WeakHashMap, metadata</td>
      </tr>
      <tr>
        <td>PhantomReference</td>
        <td>Sau khi finalize</td>
        <td>Cleanup, monitoring</td>
      </tr>
    </tbody>
  </table>
</section>
