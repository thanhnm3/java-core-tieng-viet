<section>
  <h3>Generational Heap — Chi tiết</h3>
  <p>Dựa trên <strong>Weak Generational Hypothesis</strong>: phần lớn Object chết trẻ. Young Gen nhỏ, Minor GC nhanh; Old Gen lớn, Major GC chậm nhưng ít xảy ra.</p>

  <h4>Luồng allocation</h4>
  <pre><code>new Object()
    → TLAB còn chỗ? → Allocate trong TLAB (Eden)
    → Object quá lớn? → Allocate trực tiếp Eden (slow path)
    → Eden đầy? → Minor GC
    → Object sống qua N lần GC? → Promote Old Gen
    → Old đầy? → Major/Full GC</code></pre>

  <h4>TLAB (Thread-Local Allocation Buffer)</h4>
  <p>Mỗi thread có vùng nhỏ trong Eden để allocate Object — tránh lock khi nhiều thread cùng <code>new</code>. Object lớn (vượt TLAB) allocate trực tiếp Eden. <code>-XX:+UseTLAB</code> mặc định bật. <code>-XX:TLABSize</code> tùy chỉnh (mặc định ~1% Eden).</p>

  <h4>Young Generation — Eden, Survivor</h4>
  <p><strong>Eden:</strong> Mọi allocation mới. Khi đầy → Minor GC. Object sống copy sang Survivor (Copying algorithm). <strong>S0, S1:</strong> Chỉ một active; mỗi Minor GC: copy survivor từ S0→S1 hoặc ngược lại, clear vùng cũ. Object sống qua N lần Minor GC (tenuring threshold, mặc định 15) → promote lên Old. <code>-XX:MaxTenuringThreshold=15</code>.</p>

  <h4>G1 — Region-based</h4>
  <p>G1 chia Heap thành region (1–32MB, <code>-XX:G1HeapRegionSize</code>). Mỗi region có thể Eden, Survivor, hoặc Old — không cố định. Evacuation: copy live object từ region đầy rác sang region trống. Ưu tiên region có nhiều garbage (garbage first).</p>

  <h4>Old Generation</h4>
  <p>Object promoted từ Young. Major/Full GC dọn ở đây — thường Stop-the-World lâu hơn. Thuật toán: Mark-Sweep-Compact hoặc G1 evacuation.</p>

  <table class="comparison-table">
    <caption>Thuật toán GC theo vùng</caption>
    <thead>
      <tr>
        <th>Vùng</th>
        <th>Thuật toán</th>
        <th>Đặc điểm</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>Young (Eden, Survivor)</td>
        <td>Copying</td>
        <td>Copy live object, clear toàn bộ — không fragmentation</td>
      </tr>
      <tr>
        <td>Old</td>
        <td>Mark-Sweep-Compact</td>
        <td>Mark live, sweep dead, compact để giảm fragmentation</td>
      </tr>
    </tbody>
  </table>
</section>
